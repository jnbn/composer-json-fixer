git:
    depth: 1

cache:
    directories:
        - $HOME/.composer/cache

sudo: false

language: php

notifications:
    email: false

matrix:
    include:
        - php: '5.6.30'
        - php: '7.0'
        - php: '7.1'
        - php: 'nightly'
          env: SKIP_PHP_CS_FIXER=true

before_install:
    - composer self-update --stable

install:
    - composer install --ignore-platform-reqs

script:
    - vendor/bin/phpcs --report-full --standard=PSR2 src tests
    - if [[ ! $SKIP_PHP_CS_FIXER ]]; then vendor/bin/php-cs-fixer fix --config=tests/php-cs-fixer.config.php --diff --dry-run src tests; else exit 0; fi
    - vendor/bin/phpunit -c tests/phpunit.xml
